# Nom du workflow
name: GitHub Actions Demo

# Nom de l'ex√©cution du workflow, qui inclut le nom de l'utilisateur qui a d√©clench√© le workflow
run-name: ${{ github.actor }} is testing out GitHub Actions üöÄ

# √âv√©nement qui d√©clenche le workflow, ici un push sur le d√©p√¥t
on: [push]

# D√©finition des jobs √† ex√©cuter
jobs:
  # Job pour le build
  Build:
    # Sp√©cifie que le job doit √™tre ex√©cut√© sur une machine virtuelle avec la derni√®re version d'Ubuntu
    runs-on: ubuntu-latest

    # Liste des √©tapes √† ex√©cuter dans le job
    steps:
      # √âtape 1 : Affiche un message indiquant que le job a √©t√© d√©clench√© par un √©v√©nement push
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."

      # √âtape 2 : Affiche un message indiquant que le job est en cours d'ex√©cution sur un serveur Ubuntu h√©berg√© par GitHub
      - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"

      # √âtape 3 : Affiche un message avec le nom de la branche et le d√©p√¥t
      - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."

      # √âtape 4 : Utilise l'action checkout pour cloner le d√©p√¥t sur le runner
      - name: Check out repository code
        uses: actions/checkout@v4

      # √âtape 5 : Affiche un message indiquant que le d√©p√¥t a √©t√© clon√© sur le runner
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."

      # √âtape 6 : Effectue une installation propre des d√©pendances en utilisant npm ci
      - name: Clean install dependencies
        run: |
          npm ci

      # √âtape 7 : Construit le projet en utilisant npm
      - name: Build
        run: |
          npm run build

  # Job pour les tests, qui d√©pend du job Build
  Test:
    # Ce job d√©pend du job Build, donc il ne s'ex√©cute que si le job Build r√©ussit
    needs: Build

    # Sp√©cifie que le job doit √™tre ex√©cut√© sur une machine virtuelle avec la derni√®re version d'Ubuntu
    runs-on: ubuntu-latest

    # Liste des √©tapes √† ex√©cuter dans le job
    steps:
      # √âtape 1 : Affiche un message indiquant que le job de test est en cours d'ex√©cution
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."

      # √âtape 2 : Utilise l'action checkout pour cloner le d√©p√¥t sur le runner
      - name: Check out repository code
        uses: actions/checkout@v4

      # √âtape 3 : Effectue une installation propre des d√©pendances en utilisant npm ci
      - name: Clean install dependencies
        run: |
          npm ci

      # √âtape 4 : Ex√©cute les tests end-to-end en mode headless (sans interface graphique)
      - name: Test
        run: |
          npm run e2e:headless

      # √âtape 5 : Affiche un message indiquant le statut du job
      - run: echo "üçè This job's status is ${{ job.status }}."
